<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fast Algorithms for Fitting Topic Models and Non-Negative
    Matrix Factorizations to Count Data • fastTopics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fast Algorithms for Fitting Topic Models and Non-Negative
    Matrix Factorizations to Count Data">
<meta property="og:description" content='Implements fast, scalable optimization algorithms for
    fitting topic models ("grade of membership" models) and
    non-negative matrix factorizations to count data. The methods
    exploit the special relationship between the multinomial topic
    model (also, "probabilistic latent semantic indexing") and Poisson
    non-negative matrix factorization. The package provides tools to
    compare, annotate and visualize model fits, including functions to
    efficiently create "structure plots" and identify key features in
    topics. The fastTopics package is a successor to the CountClust
    package.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">fastTopics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6-175</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stephenslab/fastTopics" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="fasttopics">fastTopics<a class="anchor" aria-label="anchor" href="#fasttopics"></a>
</h1></div>
<p><a href="https://github.com/stephenslab/fastTopics/actions" class="external-link"><img src="https://github.com/stephenslab/fastTopics/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://app.circleci.com/pipelines/github/stephenslab/fastTopics?branch=master" class="external-link"><img src="https://dl.circleci.com/status-badge/img/gh/stephenslab/fastTopics/tree/master.svg?style=svg" alt="CircleCI"></a> <a href="https://app.codecov.io/gh/stephenslab/fastTopics" class="external-link"><img src="https://codecov.io/gh/stephenslab/fastTopics/branch/master/graph/badge.svg" alt="codecov"></a></p>
<p>fastTopics is an R package implementing fast, scalable optimization algorithms for fitting topic models and non-negative matrix factorizations to count data. The methods exploit the <a href="https://stephenslab.github.io/fastTopics/articles/relationship.html" class="external-link">close relationship</a> between the topic model and Poisson non-negative matrix factorization. The package also provides tools to compare, annotate and visualize model fits, including functions to create “structure plots” and functions to identify distinctive features of topics. The fastTopics package is a successor to the <a href="https://github.com/kkdey/CountClust" class="external-link">CountClust package</a>.</p>
<p>If you find a bug, or you have a question or feedback on this software, please post an <a href="https://github.com/stephenslab/fastTopics/issues" class="external-link">issue</a>.</p>
<div class="section level2">
<h2 id="citing-this-work">Citing this work<a class="anchor" aria-label="anchor" href="#citing-this-work"></a>
</h2>
<p>If you find the fastTopics package or any of the source code in this repository useful for your work, please cite:</p>
<blockquote>
<p>K. K. Dey, C. J. Hsiao and M. Stephens (2017). <a href="https://doi.org/10.1371/journal.pgen.1006599" class="external-link">Visualizing the structure of RNA-seq expression data using grade of membership models.</a> PLoS Genetics 13, e1006599.</p>
<p>P. Carbonetto, A. Sarkar, Z. Wang and M. Stephens (2021). <a href="https://arxiv.org/abs/2105.13440" class="external-link">Non-negative matrix factorization algorithms greatly improve topic model fits.</a> arXiv 2105.13440.</p>
</blockquote>
<p>If you used the <code>de_analysis</code> function in fastTopics, please cite:</p>
<blockquote>
<p>P. Carbonetto, K. Luo, A. Sarkar, A. Hung, K. Tayeb, S. Pott and M. Stephens (2023). <a href="https://doi.org/10.1186/s13059-023-03067-9" class="external-link">GoM DE: interpreting structure in sequence count data with differential expression analysis allowing for grades of membership.</a> Genome Biology 24, 236.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>Copyright (c) 2019-2023, Peter Carbonetto and Matthew Stephens.</p>
<p>All source code and software in this repository are made available under the terms of the <a href="https://opensource.org/license/mit/" class="external-link">MIT license</a>.</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Install and load the package from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fastTopics"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stephenslab.github.io/fastTopics/" class="external-link">fastTopics</a></span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, install the latest version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"stephenslab/fastTopics"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stephenslab.github.io/fastTopics/" class="external-link">fastTopics</a></span><span class="op">)</span></span></code></pre></div>
<p>Note that installing the package will require a C++ compiler setup that is appropriate for the version of R installed on your computer. For details, refer to the documentation on the <a href="https://cran.r-project.org" class="external-link">CRAN website</a>.</p>
<p>For guidance on using fastTopics to analyze gene expression data, see the <a href="https://stephenslab.github.io/fastTopics/articles/single_cell_rnaseq_basic.html" class="external-link">single-cell RNA-seq vignette, part 1</a> and <a href="https://stephenslab.github.io/fastTopics/articles/single_cell_rnaseq_practical.html" class="external-link">part 2</a>.</p>
<p>Also, try running the small example that illustrates the fast model fitting algorithms:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="st">"fit_poisson_nmf"</span><span class="op">)</span></span></code></pre></div>
<p>See the <a href="https://stephenslab.github.io/fastTopics/" class="external-link">package documentation</a> for more information.</p>
</div>
<div class="section level2">
<h2 id="developer-notes">Developer notes<a class="anchor" aria-label="anchor" href="#developer-notes"></a>
</h2>
<p>To prepare the package for CRAN, remove the “Remotes” field in the DESCRIPTION file, and set <code>on_cran &lt;- TRUE</code> in <code>helper_functions.R</code>, then run <code>R CMD build fastTopics</code> to build the source package.</p>
<p>This is the command used to check the package before submitting to CRAN:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-hub/rhub" class="external-link">rhub</a></span><span class="op">)</span></span>
<span><span class="fu">check_for_cran</span><span class="op">(</span><span class="st">"."</span>,show_status <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  env_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`_R_CHECK_FORCE_SUGGESTS_` <span class="op">=</span> <span class="st">"false"</span>,</span>
<span>               `_R_CHECK_CRAN_INCOMING_USE_ASPELL_` <span class="op">=</span> <span class="st">"true"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="credits">Credits<a class="anchor" aria-label="anchor" href="#credits"></a>
</h2>
<p>The fastTopics R package was developed by <a href="https://pcarbo.github.io" class="external-link">Peter Carbonetto</a>, <a href="http://stephenslab.uchicago.edu" class="external-link">Matthew Stephens</a> and others.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fastTopics" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/stephenslab/fastTopics/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/stephenslab/fastTopics/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/BSD-2-Clause" class="external-link">BSD_2_clause</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fastTopics</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Peter Carbonetto <br><small class="roles"> Author, maintainer </small>  </li>
<li>Kevin Luo <br><small class="roles"> Author </small>  </li>
<li>Kushal Dey <br><small class="roles"> Author </small>  </li>
<li>Matthew Stephens <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Peter Carbonetto, Kevin Luo, Kushal Dey, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
